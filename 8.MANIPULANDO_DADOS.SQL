--TRABALHANDO COM INSERT, UPDATE E DELETE

SELECT * FROM TDESCONTO;

/*UTILIZANDO VARIAVEIS DE SUBSTITUIÇÃO NUM INSERT. 
TODA VEZ QUE É EXECUTADA, A VARIAVEL PEDE NOVOS VALORES.*/
INSERT INTO TDESCONTO(CLASSE, INFERIOR, SUPERIOR)
VALUES ('&CLA', &INF, &SUP);

SELECT * FROM TDESCONTO
WHERE CLASSE = '&CLA';


--UTILIZANDO DELETE
DELETE FROM TDESCONTO
WHERE CLASSE = '&CLA';


--FAZENDO UMA CÓPIA DA TABELA TDESCONTO UTILIZANDO SELECT
CREATE TABLE TDESCONTO2
  AS SELECT * FROM TDESCONTO;
  
SELECT * FROM TDESCONTO2;


/*DELETA SOMENTE OS REGISTROS DA TABELA, NAO A TABELA EM SI. 
NÃO TEM CLAUSULA WHERE. NÃO TEM COMO UTILIZAR ROLLBACK NESSE COM ESSE COMANDO.*/
TRUNCATE TABLE TDESCONTO2;


--DELETA TUDO
DELETE FROM TDESCONTO2;



--SAVEPOINT -> É BASICAMENTE UM PONTO DE RESTAURAÇÃO. ASSEMELHA-SE COM CHECKPOINTS EM JOGOS
--UTILIZAREMOS COMANDOS COM SUPOSTOS ERROS PARA EXEMPLIFICAR O USO DO SAVEPOINT


SAVEPOINT UPD_A;

UPDATE TDESCONTO SET
SUPERIOR = 99
WHERE CLASSE = 'A';


SAVEPOINT UPD_B;

UPDATE TDESCONTO SET
SUPERIOR = 88
WHERE CLASSE = 'B';


SAVEPOINT INS_OK;

INSERT INTO TDESCONTO(CLASSE, INFERIOR, SUPERIOR)
VALUES('&CLA', &INF, &SUP);

SELECT * FROM TDESCONTO;

ROLLBACK TO SAVEPOINT INS_OK;
ROLLBACK TO SAVEPOINT UPD_A;
ROLLBACK TO SAVEPOINT UPD_B;

DELETE FROM TDESCONTO
WHERE CLASSE = 'X';


--EXCLUIR TABELA
DROP TABLE TDESCONTO2;


