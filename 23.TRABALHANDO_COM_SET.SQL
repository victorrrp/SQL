/*OPERADORES SET -> SÃO UM CONJUNTO DE OPERAÇÕES REALIZADAS SOBRE TABELAS QUE SE 
ASSEMELHAM ÀS OPERAÇÕES REALIZADAS SOBRE CONJUNTOS NA TEORIA DOS CONJUNTOS.*/


/*
 -UNION     -> UNE OS ELEMENTOS DOS SELECT'S SEM REPETI-LOS
 -UNION ALL -> UNE TUDO QUE FOI SELECIONADO NOS SELECT'S
 -INTERSECT ->
 -MINUS     ->
*/

SELECT COD_ALUNO, TOTAL, DESCONTO
FROM TCONTRATO
WHERE COD_ALUNO = 1

UNION ALL 

SELECT COD_ALUNO, TOTAL, DESCONTO
FROM TCONTRATO
WHERE TOTAL >= 1000;



--UNION E UNION ALL COM MAIS DE DOIS SELECT
SELECT COD_CONTRATO, DATA, TOTAL, 'UNION 1' AS QUERY
FROM   TCONTRATO
WHERE  TOTAL >= 1000 AND TOTAL < 2000

UNION ALL

SELECT COD_CONTRATO, DATA, TOTAL, 'UNION 2' AS QUERY
FROM   TCONTRATO
WHERE  DESCONTO IS NOT NULL

--O UNION ABAIXO SÓ SERÁ EXECUTADO DEPOIS DE OBTER O RESULTADO DO UNION ALL ACIMA

UNION

SELECT COD_CONTRATO, DATA, TOTAL, 'UNION 3' AS QUERY
FROM   TCONTRATO
WHERE  TOTAL > 2000

ORDER BY 4;

SELECT * FROM TCONTRATO



--INTERSECT -> TRAZ RESGISTROS PRESENTES EM TODOS OS CONJUNTOS SEM REPETI-LOS
SELECT COD_CONTRATO, DATA, DESCONTO, TOTAL
FROM   TCONTRATO
WHERE  DESCONTO IS NOT NULL

INTERSECT

SELECT COD_CONTRATO, DATA, DESCONTO, TOTAL
FROM   TCONTRATO
WHERE  TOTAL > 1000

ORDER BY 1;


/*MINUS -> FAZ UMA ESPÉCIE DE SUBTRAÇÃO ENTRE TABELAS. 
MOSTRA SOMENTE OS ELEMENTOS QUE NÃO ESTÃO PRESENTES EM OUTRAS TABELAS*/
SELECT COD_CONTRATO, DATA, DESCONTO, TOTAL
FROM   TCONTRATO
WHERE  DESCONTO IS NOT NULL

MINUS

SELECT COD_CONTRATO, DATA, DESCONTO, TOTAL
FROM   TCONTRATO
WHERE  TOTAL > 2000

ORDER BY 1;


