SELECT * FROM TALUNO;

SELECT * FROM TCONTRATO;

--FAZENDO UNIÃO ENTRE OS VALORES DE TABELAS DIFERENTES


-- PRODUTO CARTESIANO - *EXEMPLO DE COMO NAO FAZER. FALTA CRITÉRIO DE UNIÃO ENTRE AS TABELAS*
SELECT TALUNO.COD_ALUNO, TALUNO.NOME, TCONTRATO.TOTAL
FROM TALUNO, TCONTRATO


-- EXEMPLO CORRETO
SELECT TALUNO.COD_ALUNO, TALUNO.NOME, TCONTRATO.TOTAL
FROM TALUNO, TCONTRATO
WHERE TALUNO.COD_ALUNO = TCONTRATO.COD_ALUNO --(CRITERIO DE UNIAO ENTRE AS TABELAS)

UPDATE TALUNO SET
NOME = 'MARCOS'
WHERE COD_ALUNO = 5


--COLUNA AMBÍGUA - *EXEMPLO ERRADO*. QUANDO O SISTEMA NÃO SABE DE ONDE PUXAR A COLUNA. 
--OCORRE QUANDO NAO SE COLOCA O CRITERIO DE UNIÃO
SELECT COD_ALUNO, TALUNO.NOME, TCONTRATO.TOTAL
FROM TALUNO, TCONTRATO
WHERE TALUNO.COD_ALUNO = TCONTRATO.COD_ALUNO


--UNIÃO DA TABLEA DE ALUNO COM CONTRATO
--COLOCANDO DE FORMA MAIS ORGANIZADA UTILIZANDO APELIDOS NO FROM
SELECT ALU.COD_ALUNO, ALU.NOME AS ALUNO,
       CON.COD_CONTRATO, CON.DATA, CON.TOTAL

FROM TALUNO ALU, TCONTRATO CON
WHERE CON.COD_ALUNO = ALU.COD_ALUNO

--COMPLETANDO O SELECT
AND UPPER(ALU.NOME) LIKE '%'
ORDER BY ALU.COD_ALUNO


--UTLIZANDO MAIS TABELAS NA UNIAO. FAZENDO RELACIONAMENTOS ENTRE ELAS
SELECT * FROM TALUNO
SELECT * FROM TCONTRATO
SELECT * FROM TITEM
SELECT * FROM TCURSO
 
--FAÇA O SELECT COM AS TABELAS
SELECT ALU.COD_ALUNO, ALU.NOME AS ALUNO,
       CON.COD_CONTRATO, CON.DATA, CON.TOTAL,
       ITE.COD_CURSO, CUR.NOME AS CURSO,
       ITE.VALOR

--UTILIZE O FROM PARA FAZER AS ABREVIAÇÕES DE TABELAS
FROM TALUNO ALU, TCONTRATO CON,
     TITEM ITE, TCURSO CUR

--CONSTRUA O CRITERIO DE UNIÃO
--PARA QUE O INSERT FUNCIONE, É NECESSÁRIO COLOCAR O (+) PARA QUE SE RELACIONEM
WHERE ALU.COD_ALUNO = CON.COD_ALUNO(+)
AND   CON.COD_CONTRATO = ITE.COD_CONTRATO(+)
AND   ITE.COD_CURSO = CUR.COD_CURSO(+)


ORDER BY CON.TOTAL DESC;


INSERT INTO TALUNO VALUES (10, 'CLAUDIA', 'CURRAIS NOVOS', NULL, NULL, NULL, NULL)


--FAZENDO UM SELECT ONDE AS COLUNAS NAO COINCIDEM
CREATE TABLE TDESCONTO
       ( CLASSE VARCHAR(1) PRIMARY KEY,
         INFERIOR NUMBER(4,2),
         SUPERIOR NUMBER(4,2)
        );

INSERT INTO TDESCONTO VALUES ('A', 00,10);
INSERT INTO TDESCONTO VALUES ('B', 11,15);
INSERT INTO TDESCONTO VALUES ('C', 16,20);
INSERT INTO TDESCONTO VALUES ('D', 21,25);
INSERT INTO TDESCONTO VALUES ('E', 26,30);

SELECT * FROM TDESCONTO;

COMMIT;   

---------------------

SELECT * FROM TCONTRATO;

UPDATE TCONTRATO SET 
DESCONTO = 27
WHERE COD_CONTRATO = 6;

UPDATE TCONTRATO SET
DESCONTO = 18
WHERE COD_CONTRATO = 5;  

UPDATE TCONTRATO SET
DESCONTO = 25
WHERE COD_CONTRATO = 2;

UPDATE TCONTRATO SET
DESCONTO = 12
WHERE COD_CONTRATO = 4;
  
    
--CLASSIFICANDO OS CONTRATOS PELA FAIXA DE DESCONTO
SELECT CON.COD_CONTRATO AS CONTRATO, CON.DESCONTO,
       DES.CLASSE AS DESCONTO

FROM   TCONTRATO CON, TDESCONTO DES
WHERE NVL(CON.DESCONTO, 0) BETWEEN DES.INFERIOR AND DES.SUPERIOR
                           
ORDER BY CON.COD_CONTRATO;

--MOSTRANDO CURSOS VENDIDOS
SELECT CUR.COD_CURSO, CUR.NOME, ITE.VALOR
FROM TCURSO CUR, TITEM ITE
WHERE CUR.COD_CURSO = ITE.COD_CURSO
ORDER BY CUR.NOME

--MOSTRANDO CURSOS NAO VENDIDOS
SELECT CUR.COD_CURSO, CUR.NOME, ITE.COD_ITEM
FROM TCURSO CUR, TITEM ITE
WHERE CUR.COD_CURSO = ITE.COD_CURSO(+)
AND ITE.COD_ITEM IS NULL;


INSERT INTO TCURSO VALUES (6, 'PHP', 1000, 100, NULL);
INSERT INTO TCURSO VALUES (7, 'LOGICA', 100, 20, NULL);


--INSERINDO UMA COLUNA NA TABELA DE CURSO

ALTER TABLE TCURSO ADD PRE_REQ INTEGER;

SELECT * FROM TCURSO

UPDATE TCURSO SET PRE_REQ = 7
       WHERE COD_CURSO = 1;

UPDATE TCURSO SET PRE_REQ = 7
       WHERE COD_CURSO = 3;

UPDATE TCURSO SET PRE_REQ = 1
       WHERE COD_CURSO = 2;

UPDATE TCURSO SET PRE_REQ = 7
       WHERE COD_CURSO = 6;
       
--FAZENDO UM SELECT QUE MOSTRA NOME DO CURSO E SEU PRÉ REQUISITO

SELECT CURSO.NOME AS CURSO,
       PRE_REQ.NOME AS PRE_REQUISITO
       
FROM TCURSO CURSO, TCURSO PRE_REQ
WHERE CURSO.PRE_REQ = PRE_REQ.COD_CURSO(+);

